# A Comparison of ML Methods for AMR Gene Class Prediction in FMT Patients

## Project Overview
Antimicrobial resistance (AMR), a major modern healthcare problem, can be limited by supplementing heavy antibiotic regimes with treatments called fecal microbiota transplants (FMTs) in the case of patients for whom antibiotics have become ineffective. Machine learning (ML) methods have emerged as a potentially fast and effective way to visualize and predict AMR gene dynamics, though there have been few direct comparisons between different machine learning methods within this application. This research aims to establish direct comparisons between different machine learning methods in analyzing or predicting frequencies of antimicrobial resistance genes in post-FMT patients.

## Required Python Packages
The following Python software libraries were utilized:
- `pandas`: Used for importing data and general data structure manipulation.
- `numpy`: Used for data structure manipulation.
- `scikit-learn`: Used for implementing various ML algorithms (RandomForestRegressor, linear_regression.Lasso, PCA, and TSNE) and data preprocessing (euclidean_distances).
- `scikit-bio`: Used for center log ratio data preprocessing (clr). 
- `xgboost`: Used for implementing XGBoost model algorithms (XGBRegressor).
- `optuna`: Used for hyperparameter optimization & model comparison.
- `shap`: Used for feature importance modeling and data visualization.
- `matplotlib` & `seaborn`: Used for data visualization of plots and graphs.
- `joblib`: Used to save and load models and trials for repetition.

## Input Files
- `Predictors_Cleaned.xlsx`: Patient Sample Metadata
- `Outcomes_Cleaned.xlsx`: Patient AMR Gene Counts Matrix

## Directory
### README.txt
Contains all markdown text for this README

### Optuna
#### Graphs
Contains individual model r-squared output graphs generated by `optuna.ipynb` in both PNG and SVG format. 
#### lassoModels
Contains `.joblib` files for each optimal LASSO model generated for each AMR gene class.
#### rfModels
Contains `.joblib` files for each optimal Random Forest model generated for each AMR gene class.
#### xgbModels
Contains `.joblib` files for each optimal XGBoost model generated for each AMR gene class.
#### optuna.ipynb
This notebook contains the majority of the code written to optimize and iterate the creation of supervised models for this project.
#### small_r2_graph.svg
This graph was generated for a poster presentation, it is a subset of data contained in `stacked_r2_graph.png`.
#### stacked_r2_graph.png
This graph is a overall comparison of supervised machine learning model correlation coefficients for FMT patient gene classes.

### PCA (folder)
#### pcaNotebook.ipynb
This notebook contains all code written to model PCA for this project.

### SHAP (folder)
#### SHAPNotebook.ipynb
This notebook contains all code written to create SHAP graphs for this project.
#### shap_summary.svg & shap_summary.png
These graphs were generated for a poster presentation, they are SHAP beeswarm plots for all XGBoost QAC samples.

### t-SNE (folder)
#### Figures
Contains individual t-SNE graphs for each predictor and perplexity generated by `tsneNotebook.ipynb` in PNG and SVG format.
#### Results_by_Feature
Contains graphs for each predictor with  all of its t-SNE graphs generated by `tsneNotebook.ipynb` in PNG format.
#### tsneNotebook.ipynb
This notebook contains all code written to model t-SNE for this project.
